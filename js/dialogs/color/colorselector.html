<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="stylesheet" href="dialog.css" type="text/css" />
<title>Select Color Dialog</title>
</head>
<body>
<table cellpadding="0" cellspacing="0" border="0" width="100%" style="height:100%">
<tr>
	<td  class="ColorSelectorTitle">Select Color</td>
</tr>
<tr>
<td valign="middle" class="content">
	<table cellpadding="10" cellspacing="0" border="0" >
	<tr>
		<td valign="top">
			<table cellpadding="0" cellspacing="0" border="0" id="ColorTable" onmouseout="document.getElementById('hicolor').style.backgroundColor= document.body.style.backgroundColor" ></table>
		</td>
		<td valign="top">
		Active Color	
		<div id="hicolor"></div>
		<div id="hicolortext"></div>
		Selected
		<div id="selhicolor"></div>
			<input id="selcolor" type="text" maxlength="20" onChange="UpdateColor();">
		</td>
	</tr>
</table>
</td>
</tr>
<tr>
	<td align="right" colspan="2" class="ColorSelectorFooter">
		<input type="button" value="Cancel" onclick="window.close();" />
		<input type="button" style="width:50px" value="Ok" onclick="OnResult(); window.close();" />
	</td>
</tr>
</table>
<script language="JavaScript" type="text/javascript">
//window.parent.ColorDlg.Color
	var aColors = ['00','33','66','99','cc','ff'] ;
	var oTable = document.getElementById('ColorTable') ;
	
	function OnResult(){
		var w=window;
		w = w.opener;
		if ( w ){
			w.ColorDlg.ie = false;
			w.ColorDlg.setVal(document.getElementById('selcolor').value);
		}
		else
			window.returnValue=document.getElementById('selcolor').value;
	}
	
	function AppendColorRow( rangeA, rangeB )
	{
		for ( var i = rangeA ; i < rangeA + 3 ; i++ ) 
		{ 
			var oRow = oTable.insertRow(-1) ; 

			for ( var j = rangeB ; j < rangeB + 3 ; j++ ) 
			{ 
				for ( var n = 0 ; n < 6 ; n++ ) 
				{ 
					AppendColorCell( oRow, '#' + aColors[j] + aColors[n] + aColors[i] ) ; 
				} 
			} 
		}
	}

	// This function create a single color cell in the color table.
	function AppendColorCell( targetRow, color )
	{
		var oCell = targetRow.insertCell(-1) ;
		oCell.className = 'ColorCell' ;
		oCell.bgColor = color ;
		
		oCell.onmouseover = function()
		{
			document.getElementById('hicolor').style.backgroundColor = this.bgColor ;
			document.getElementById('hicolortext').innerHTML = this.bgColor ;
		}
		
		oCell.onclick = function()
		{
			document.getElementById('selhicolor').style.backgroundColor = this.bgColor ;
			document.getElementById('selcolor').value = this.bgColor ;
		}
	}

	AppendColorRow( 0, 0 ) ;
	AppendColorRow( 3, 0 ) ;
	AppendColorRow( 0, 3 ) ;
	AppendColorRow( 3, 3 ) ;
	// Create the last row.
	var oRow = oTable.insertRow(-1) ;
	
	// Create the gray scale colors cells.
	for ( var n = 0 ; n < 6 ; n++ )
	{
		AppendColorCell( oRow, '#' + aColors[n] + aColors[n] + aColors[n] ) ; 
	}
	
	// Fill the row with black cells.
	for ( var i = 0 ; i < 12 ; i++ )
	{
		AppendColorCell( oRow, '#000000' ) ; 
	}
	
	
	function UpdateColor(){
		try		  { document.getElementById('selhicolor').style.backgroundColor = document.getElementById('selcolor').value ; }
		catch (e) { Clear() ; }
	}
	
	/*function ClearActual()
	{
		document.getElementById('hicolor').style.backgroundColor = '' ;
	}*/
	
</script>
</body>
</html>
